<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_invoice_payment_dues">
        <t t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})" />

        <div t-if="doc_opts.payment_term_position == 'footer' or (doc_opts.payment_term_position == 'auto' and len(o.due_records) > 1)"  class="col-xs-6 pull-left" style="padding-top:1px; padding-left:0px; padding-right:0px; page-break-inside: avoid;">
            <p><strong>Payment Term:</strong></p>
            <p t-if="o.payment_term_id.note" t-field="o.payment_term_id.note"/>
            <p t-if="not o.payment_term_id.note" t-field="o.payment_term_id"/>
            <p t-if="o.type in ['in_refund', 'out_refund']"><strong >Refunds:</strong></p>
            <p t-if="o.type in ['in_invoice', 'out_invoice']"><strong >Payments:</strong></p>
            <p t-if="o.partner_bank_id and doc_opts.payment_term_position == 'footer'">
                <strong>IBAN:</strong>
                <span t-field="o.partner_bank_id.display_name"/>
            </p>
            <p t-if="not o.partner_bank_id and o.partner_id.bank_ids and o.payment_term_id and o.payment_term_id.riba or o.payment_term_id.fatturapa_pm_id.code in ('MP11', 'MP12', 'MP16', 'MP17', 'MP19', 'MP20', 'MP21') and doc_opts.payment_term_position == 'footer'">
                <strong>IBAN:</strong>
                <p>
                    <t t-foreach="o.partner_id.bank_ids" t-as="bank"><span t-field="bank.display_name"/></t>
                </p>
            </p>
            <p t-if="not o.partner_bank_id and o.company_id.partner_id.bank_ids and o.payment_term_id and o.payment_term_id.fatturapa_pm_id.code in ('MP05', 'MP07', 'MP08', 'MP13', 'MP18') and doc_opts.payment_term_position == 'footer'">
                <strong>IBAN:</strong>
                <p>
                    <t t-foreach="o.company_id.partner_id.bank_ids" t-as="bank"><span t-if="len(bank.display_name) &gt; 16" t-field="bank.display_name"/></t>
                </p>
            </p>
            <table class="table table-condensed">
                <thead >
                    <tr>
                        <th>N.</th>
                        <th>Data</th>
                        <th>Importo</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="o.due_records" t-as="p">
                        <tr>
                            <td><span t-esc="p_index + 1"/></td>
                            <td><span t-field="p.date_maturity"/></td>
                            <td t-if="o.type in ['in_refund', 'out_invoice']" class="text-right"><span t-field="p.debit"/></td>
                            <td t-if="o.type in ['in_invoice', 'out_refund']" class="text-right"><span t-field="p.credit"/></td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </div>

    </template>

</odoo>

